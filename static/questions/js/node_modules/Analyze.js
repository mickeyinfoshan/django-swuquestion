//send the request and get the result

var jsonp = require("jsonp");
var removeBrace = require("./tools/removeBrace.js")

module.exports = function(text, fn) {
	text = removeBrace(text);
	var base     = "http://ltpapi.voicecloud.cn/analysis/?";
    var api_key  = "r3V2w3W9bXtZNXDIbqqlbY0IOPZpQh2bdhOupgcK";
    var pattern  = 'all';
    var format   = "json";
    var uri      = (base
    + "api_key="   + api_key   + "&text="   + text
    + "&pattern="  + pattern   + "&format=" + format
    + "&callback=analyzeCallback"
    );

    var analyzeCallback = fn;

    jsonp(uri, {
        name : "analyzeCallback"
    });
};